## 1、什么是nginx？nginx的优点有哪些？
答：
Nginx是一款轻量级的 Web服务器 / 反向代理服务器 / 电子邮件（IMAP/POP3）代理服务器，主要的优点是：  
支持高并发连接，尤其是静态界面，官方测试Nginx能够支撑5万并发连接  
内存占用极低  
配置简单，使用灵活，可以基于自身需要增强其功能，同时支持自定义模块的开发  
使用灵活：可以根据需要，配置不同的负载均衡模式，URL地址重写等功能  
稳定性高，在进行反向代理时，宕机的概率很低  
支持热部署，应用启动重载非常迅速  

## 2、nginx能做什么？
答：
- 网关 （面向客户的总入口）
网关可以拦截客户端所有请求，对该请求进行权限控制、负载均衡、日志管理、接口调用监控等，因此无论使用什么架构体系，都可以使用Nginx作为最外层的网关。  

- 虚拟主机（为不同域名 / ip / 端口提供服务。如：VPS虚拟服务器）


- 路由（正向代理 / 反向代理）
正向代理  

代理客户;  
隐藏真实的客户，为客户端收发请求，使真实客户端对服务器不可见;  
一个局域网内的所有用户可能被一台服务器做了正向代理，由该台服务器负责 HTTP 请求;  
意味着同服务器做通信的是正向代理服务器;  

反向代理  

代理服务器;  
隐藏了真实的服务器，为服务器收发请求，使真实服务器对客户端不可见;  
负载均衡服务器，将用户的请求分发到空闲的服务器上;  
意味着用户和负载均衡服务器直接通信，即用户解析服务器域名时得到的是负载均衡服务器的 IP ;  

- 静态服务器

- 负载集群（提供负载均衡）
轮询、指定权重、IP Hash、fair、url_hash


## 3、nginx如何解决惊群现象？
答：
惊群效应（thundering herd）是指多进程（多线程）在同时阻塞等待同一个事件的时候（休眠状态），如果等待的这个事件发生，那么他就会唤醒等待的所有进程
（或者线程），但是最终却只能有一个进程（线程）获得这个时间的“控制权”，对该事件进行处理，而其他进程（线程）获取“控制权”失败，只能重新进入休眠状态，
这种现象和性能浪费就叫做惊群效应。  
上文中介绍了Nginx的多进程模型，而典型的多进程模型正如文中所说，多个worker进程之间是对等的，因此当一个请求到来的时候，所有进程会同时开始竞争，
最终执行的又只有一个，这样势必会造成资源的浪费。
Nginx解决该问题的思路是：不让多个进程在同一时间监听接受连接的socket，而是让每个进程轮流监听，这样当有连接过来的时候，
就只有一个进程在监听那肯定就没有惊群的问题。
具体做法是：利用一把进程间锁，每个进程中都尝试获得这把锁，如果获取成功将监听socket加入wait集合中，并设置超时等待连接到来，
没有获得锁的进程则将监听socket从wait集合去除。


## 4、nginx如何解决CORS跨域问题？
答：
两个思路
- 基于多路由，把跨域的两个请求发到各自的服务器，然后统一访问入口即可避免该问题
- 利用Nginx配置Headerd的功能，为其附上相应的请求头


## 5、为什么nginx这么快？
答：
如果一个server采用一个进程负责一个request的方式，那么进程数就是并发数。那么显而易见的，就是会有很多进程在等待中。等什么？最多的应该是等待网络传输。  
而nginx 的异步非阻塞工作方式正是利用了这点等待的时间。在需要等待的时候，这些进程就空闲出来待命了。因此表现为少数几个进程就解决了大量的并发问题。  
nginx是如何利用的呢，简单来说：同样的4个进程，如果采用一个进程负责一个request的方式，那么，同时进来4个request之后，每个进程就负责其中一个，直至会话关闭。
期间，如果有第5个request进来了。就无法及时反应了，因为4个进程都没干完活呢，因此，一般有个调度进程，每当新进来了一个request，就新开个进程来处理。  
nginx不这样，每进来一个request，会有一个worker进程去处理。但不是全程的处理，处理到什么程度呢？处理到可能发生阻塞的地方，
比如向上游（后端）服务器转发request，并等待请求返回。那么，这个处理的worker不会这么傻等着，他会在发送完请求后，注册一个事件：“如果upstream返回了，
告诉我一声，我再接着干”。于是他就休息去了。此时，如果再有request 进来，他就可以很快再按这种方式处理。而一旦上游服务器返回了，就会触发这个事件，
worker才会来接手，这个request才会接着往下走。  
由于web server的工作性质决定了每个request的大部份生命都是在网络传输中，实际上花费在server机器上的时间片不多。这是几个进程就解决高并发的秘密所在。  

总结：事件模型，异步非阻塞，多进程模型加上细节优化的共同作用



